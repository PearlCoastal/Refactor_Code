# 7.3 ä»¥å¯¹è±¡å–ä»£åŸºæœ¬ç±»å‹

![](../img/7.3.jpg)

## ä½¿ç”¨åœºæ™¯

- ä¸€æ—¦å‘ç°å¯¹æŸä¸ªæ•°æ®çš„æ“ä½œä¸ä»…ä»…å±€é™äºæ‰“å°æ—¶ï¼Œå°±ä¼šä¸ºå®ƒåˆ›å»ºä¸€ä¸ªæ–°ç±»

- å°å°çš„å°è£…å¼€å§‹å¯èƒ½ä»·å€¼ç”šå¾®ï¼Œåªæœ‰æ‚‰å¿ƒç…§æ–™ï¼Œä»–ä»¬å¾ˆå¿«å°±èƒ½æˆä¸ºæœ‰ç”¨çš„å·¥å…·

### é‡æ„å‰

```java
class Order
{
    constructor(data)
    {
        this.priority = data.priority;
        // more initialization
    }
}
```

- client

```java
highPriorityCount = orders.filter(o = > "high" == = o.priority || "rush" == = o.priority)
                        .length;
```

### STEP1. å°è£…å˜é‡

```java
class Order
{
    constructor(data)
    {
        this.priority = data.priority;
        // more initialization
    }
    get priority() { return this._priority; }
    set priority(aString) { this._priority = aString; }
}
```

### STEP2. ä¸ºæ•°æ®å€¼åˆ›å»ºä¸€ä¸ªç±»ï¼Œç±»çš„æ„é€ å‡½æ•°åº”è¯¥ä¿å­˜è¿™ä¸ªæ•°æ®å€¼ï¼Œå¹¶æœªå®ƒæä¾›ä¸€ä¸ªå–å€¼å‡½æ•°

```java
classs Priority
{
    constructor(value) { this._value = value; }
    toString() { return this._value; }
}
```

### STEP3. ä¿®æ”¹è®¿é—®å‡½æ•°ï¼Œä½¿å…¶ç”¨ä¸Šæ–°åˆ›å»ºçš„ç±»

```java
class Order
{
    get priority() { return this._priority.toString(); }
    set priority(aString)
    {
        this._priority = new Priority(aString);
    }
}
```

- `get priority` çš„åå­—æœ‰ç‚¹å¿½æ‚ äºº

```java
class Order
{
    get priorityString() { return this._priority.toString(); }
}
```

- client

```java
highPriorityCount = orders.filter(o = > "high" == = o.priorityString || "rush" == = o.priorityString)
                        .length;
```

### STEP4. ä¼˜åŒ–

- è®©clientç›´æ¥ä½¿ç”¨ `Priority` å¯¹è±¡æ˜¯å¦ä¼šæ›´å¥½

```java
class Order
{
    get priority() { return this._priority; }
    get priorityString() { return this._priority.toString(); }
    set priority(aString) { this._priority = new Priority(aString); }
}
```

- client

```java
highPriorityCount = orders.filter(o = > "high" == = o.priority.toString() || "rush" == = o.priority.toString())
                        .length;
```

- è®©Orderç±»çš„å®¢æˆ·ç«¯æ‹¿ç€ `Priority` å®ä¾‹æ¥è°ƒç”¨è®¾ç½®å‡½æ•°

```java
class Priority
{
    constructor(value)
    {
        if (value instanceof Priority)
            return value;
        this._value = value;
    }
}
```

- è®© `Priority` ç±»æ”¯æŒæ›´å¤šçš„ä¸šåŠ¡è¡Œä¸º

```java
class Priority
{
    constructor(value)
    {
        if (value instanceof Priority)
            return value;
        if (Priority.legalValues().includes(value))
            this._value = value;
        else
throw new Error(`<${value}> is invalid for Priority`);
    }
    toString() { return this._value; }
    get _index() { return Priority.legalValues().findIndex(s = > s == = this._value); }
    static legalValues() { return [ 'low', 'normal', 'high', 'rush' ]; }
    equals(other) { return this._index == = other._index; }
    higherThan(other) { return this._index > other._index; }
    lowerThan(other) { return this._index < other._index; }
}
```

- client

```java
highPriorityCount = orders.filter(o = > o.priority.higherThan(new Priority("normal")))
                        .length;
```

## é‡æ„å®ŒæˆğŸ€
