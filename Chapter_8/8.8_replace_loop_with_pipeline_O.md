# 8.8 ä»¥ç®¡é“å–ä»£å¾ªç¯

## ä½¿ç”¨åœºæ™¯ è¿­ä»£ä¸€ç»„é›†åˆæ—¶å¾—ç”¨å¾ªç¯ -> ç”¨ç®¡é“æ¥å¤„ç†è¿­ä»£è¿‡ç¨‹

* @Date: 2023-04-24 10:01:45

### é‡æ„å‰

* csv æ–‡ä»¶

```CSV

office, country, telephone

Chicago, USA, +1 312 373 1000

Beijing, China, +86 4008 900 505

Bangalore, India, +91 80 4064 9570

Porto Alegre, Brazil, +55 51 3079 3550

Chennai, India, +91 44 660 44766

... (more data follows)
```

* ä»æ•°æ®ä¸­ç­›é€‰å‡ºå°åº¦çš„æ‰€æœ‰åŠå…¬å®¤ï¼Œå¹¶è¿”å›åŠå…¬å®¤æ‰€åœ¨çš„cityå’Œtelephone number

```java
function acquireData(input)
{
    const lines = input.split("\n");
    let firstLine = true;
    const result = [];
    for (const line of lines)
    {
        if (firstLine)
        {
            firstLine = false;
            continue;
        }
        if (line.trim() == = "")
            continue;
        const record = line.split(",");
        if (record[1].trim() == = "India")
        {
            result.push({city : record[0].trim(), phone : record[2].trim()});
        }
    }
    return result;
}
```

### STEP1. å…ˆåˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„å˜é‡ï¼Œç”¨æ¥å­˜æ”¾å‚ä¸å¾ªç¯è¿‡ç¨‹çš„é›†åˆå€¼

```java
function acquireData(input)
{
    const lines = input.split("\n");
    let firstLine = true;
    const result = [];
    // NOTE: åˆ›å»ºä¸€ä¸ªç‹¬ç«‹å˜é‡ loopItems
    const loopItems = lines for (const line of loopItems)
    {
        if (firstLine)
        {
            firstLine = false;
            continue;
        }
        if (line.trim() == = "")
            continue;
        const record = line.split(",");
        if (record[1].trim() == = "India")
        {
            result.push({city : record[0].trim(), phone : record[2].trim()});
        }
    }
    return result;
}
```

### STEP2

### å¾ªç¯ç¬¬ä¸€éƒ¨åˆ†çš„ä½œç”¨æ˜¯åœ¨å¿½ç•¥CSVæ–‡ä»¶çš„ç¬¬ä¸€è¡Œæ•°æ®ï¼šç”¨åˆ‡ç‰‡æ“ä½œå–ä»£

### ä»å¾ªç¯ä¸­ç§»é™¤è¿™éƒ¨åˆ†ä»£ç ï¼Œå¹¶åœ¨é›†åˆå˜é‡çš„å£°æ˜åé¢æ–°å¢ä¸€ä¸ªå¯¹åº”çš„sliceè¿ç®—æ¥æ›¿ä»£

```java
function acquireData(input)
{
    const lines = input.split("\n");
    // let firstLine = true;
    const result = [];
    // NOTE: åˆ©ç”¨åˆ‡ç‰‡æ“ä½œæ›¿ä»£ firstLine
    const loopItems = lines.slice(1);
    for (const line of loopItems)
    {
        // if (firstLine)
        // {
        //     firstLine = false;
        //     continue;
        // }
        if (line.trim() == = "")
            continue;
        const record = line.split(",");
        if (record[1].trim() == = "India")
        {
            result.push({city : record[0].trim(), phone : record[2].trim()});
        }
    }
    return result;
}
```

### STEP3. å¾ªç¯ä¸­ç¬¬äºŒéƒ¨åˆ†æ“ä½œæ˜¯åœ¨åˆ é™¤æ•°æ®ä¸­çš„æ‰€æœ‰ç©ºè¡Œï¼Œç”¨è¿‡æ»¤è¿ç®—æ›¿ä»£

```java
function acquireData(input)
{
    const lines = input.split("\n");
    const result = [];

    // NOTE: ç”¨è¿‡æ»¤è¿ç®—å–ä»£if trimæ“ä½œ
    const loopItems = lines
                          .slice(1)
                          .filter(line = > line.trim() != = "");
    for (const line of loopItems)
    {
        // if (line.trim() == = "")
        //     continue;
        const record = line.split(",");
        if (record[1].trim() == = "India")
        {
            result.push({city : record[0].trim(), phone : record[2].trim()});
        }
    }
    return result;
}
```

### STEP4

### å¾ªç¯ä¸­å°†åŸå§‹æ•°æ®çš„ä¸€è¡Œè½¬æ¢æˆæ•°ç»„ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªmapè¿ç®—æ›¿ä»£

### recordå‘½åçš„è¯¯å¯¼æ€§ï¼Œä»–æ²¡æœ‰ä½“ç°å‡º"è½¬æ¢å¾—åˆ°çš„ç»“æœæ˜¯æ•°ç»„"

```java
function acquireData(input)
{
    const lines = input.split("\n");
    const result = [];
    const loopItems = lines
                          .slice(1)
                          .filter(line = > line.trim() != = "")
                          .map(line = > line.split(","));
    for (const line of loopItems)
    {
        const record = line;
        .split(",");
        if (record[1].trim() == = "India")
        {
            result.push({city : record[0].trim(), phone : record[2].trim()});
        }
    }
    return result;
}
```

### ç”¨è¿‡æ»¤æ“ä½œæ›¿ä»£ record[1].trim()  == = "India"

```java
function acquireData(input)
{
    const lines = input.split("\n");
    const result = [];
    const loopItems = lines
                          .slice(1)
                          .filter(line = > line.trim() != = "")
                          .map(line = > line.split(","))
                          .filter(record = > record[1].trim() == = "India");
    for (const line of loopItems)
    {
        const record = line;
        // if (record[1].trim() == = "India")
        // {
        result.push({city : record[0].trim(), phone : record[2].trim()});
        // }
    }
    return result;
}
```

### STEP5

### å¾ªç¯å‰©ä½™çš„å”¯ä¸€ä½œç”¨ï¼šå¯¹ç´¯åŠ å˜é‡èµ‹å€¼

### å¯ä»¥ä»ä¸Šé¢ç®¡é“äº§ç”Ÿå‡ºçš„ç»“æœèµ‹å€¼ç»™è¯¥ç´¯åŠ å˜é‡ï¼Œç„¶ååˆ é™¤å¾ªç¯

```java
function acquireData(input)
{
    const lines = input.split("\n");
    const result = lines
                       .slice(1)
                       .filter(line = > line.trim() != = "")
                       .map(line = > line.split(","))
                       .filter(record = > record[1].trim() == = "India")
                       .map(record = > ({city : record[0].trim(), phone : record[2].trim()}));
    // for (const line of loopItems)
    // {
    // const record = line;
    // result.push(line);
    // }
    return result;
}
```

### STEP6. æ¸…ç†å·¥ä½œ

### 1. å†…è” result å˜é‡ï¼Œä¸ºä¸€äº›å‡½æ•°å˜é‡æ”¹å

### 2. é‡æ–°å¸ƒå±€

```java
function acquireData(input)
{
    const lines = input.split("\n");
    return lines
        .slice(1)
        .filter(line = > line.trim() != = "")
        .map(line = > line.split(","))
        .filter(fields = > fields[1].trim() == = "India")
        .map(fields = > ({city : fields[0].trim(), phone : fields[2].trim()}));
}
```

### é‡æ„å®ŒæˆğŸ€
