# 6.11 æ‹†åˆ†é˜¶æ®µ

![](../img/6.11.jpg)

## ä½¿ç”¨åœºæ™¯

- ä¸€æ®µä»£ç åœ¨åŒæ—¶å¤„ç†ä¸¤ä»¶ä¸åŒçš„äº‹æƒ…ï¼Œå¯ä»¥æ‹†åˆ†æˆå„è‡ªç‹¬ç«‹çš„æ¨¡å—

### é‡æ„å‰

```java
function priceOrder(product, quantity, shippingMethod)
{
    // 1. è®¡ç®—è®¢å•ä¸­ä¸å•†å“ç›¸å…³çš„ä»·æ ¼
    const basePrice = product.basePrice *quantity;
const discount = Math.max(quantity - product.discountThreshold, 0)* product.basePrice * product.discountRate;

    // 2. æ ¹æ® shipping ä¿¡æ¯è®¡ç®—é…é€æˆæœ¬
    const shippingPerCase = (basePrice > shippingMethod.discountThreshold)
                                ? shippingMethod.discountedFee
                                : shippingMethod.feePerCase;
    const shippingCost = quantity * shippingPerCase;

    const price = basePrice - discount + shippingCost;
    return price;
}
```

### STEP1. æç‚¼å‡½æ•°

```java
function priceOrder(product, quantity, shippingMethod)
{
    const basePrice = product.basePrice *quantity;
const discount = Math.max(quantity - product.discountThreshold, 0)* product.basePrice * product.discountRate;
    const price = applyShipping(basePrice, shippingMethod, quantity, discount);
    return price;
}
```

- å°†è®¡ç®—é…é€æˆæœ¬çš„é€»è¾‘æç‚¼å‡ºæ¥

```java
function applyShipping(basePrice, shippingMethod, quantity, discount)
{
    const shippingPerCase = (basePrice > shippingMethod.discountThreshold)
                                ? shippingMethod.discountedFee
                                : shippingMethod.feePerCase;
    const shippingCost = quantity * shippingPerCase;
    const price = basePrice - discount + shippingCost;
    return price;
}
```

### STEP2. å¼•å…¥ä¸€ä¸ªä¸­è½¬æ•°æ®ç»“æ„ `priceData` ï¼Œåœ¨ä¸¤é˜¶æ®µä¹‹é—´æ²Ÿé€šä¿¡æ¯

- æ£€æŸ¥ `applyShipping` ä¸­çš„å„ä¸ªå‚æ•°ï¼š
- 1. `basePrice` ï¼šæ˜¯åœ¨ç¬¬ä¸€é˜¶æ®µä¸­åˆ›å»ºçš„ï¼Œç§»å…¥ `priceData`
- 2. `shippingMethod` ï¼šç¬¬ä¸€é˜¶æ®µä¸­æ²¡æœ‰ä½¿ç”¨è¿™é¡¹æ•°æ®ï¼Œä¿ç•™åŸæ ·
- 3. `quantity` ï¼šåœ¨ç¬¬ä¸€é˜¶æ®µç”¨åˆ°ï¼Œä½†æ˜¯ä¸æ˜¯åœ¨ç¬¬ä¸€é˜¶æ®µä¸­åˆ›å»ºçš„ï¼Œå¯ä»¥ä¿ç•™ï¼Œä½†ä½œè€… prefer å°†æ›´å¤šçš„å‚æ•°æ¬ç§»åˆ°ä¸­è½¬æ•°æ®ç»“æ„ä¸­
- 4. `discount` ï¼šåœ¨ç¬¬ä¸€é˜¶æ®µä¸­åˆ›å»ºï¼Œç§»å…¥ä¸­è½¬æ•°æ®ç»“æ„ä¸­

```java
function priceOrder(product, quantity, shippingMethod)
{
    const basePrice = product.basePrice * quantity;
    const discount = Math.max(quantity - product.discountThreshold, 0) * product.basePrice * product.discountRate;
    const priceData = {basePrice : basePrice, quantity : quantity, discount : discount};
    const price = applyShipping(priceData, shippingMethod);
    return price;
}
```

- ä¿®æ”¹ `applyShipping` çš„å…¥å‚

```java
function applyShipping(priceData, shippingMethod, discount)
{
    const shippingPerCase = (priceData.basePrice > shippingMethod.discountThreshold)
                                ? shippingMethod.discountedFee
                                : shippingMethod.feePerCase;
    const shippingCost = priceData.quantity * shippingPerCase;
    const price = priceData.basePrice - priceData.discount + shippingCost;
    return price;
}
```

### STEP3. å°†ç¬¬ä¸€é˜¶æ®µä»£ç æç‚¼æˆç‹¬ç«‹çš„å‡½æ•°ï¼Œè¿”å›ä¸­è½¬æ•°æ®ç»“æ„

```java
function priceOrder(product, quantity, shippingMethod)
{
    const priceData = calculatePricingData(product, quantity);
    const price = applyShipping(priceData, shippingMethod);
    return price;
}
function calculatePricingData(product, quantity)
{
    const basePrice = product.basePrice * quantity;
    const discount = Math.max(quantity - product.discountThreshold, 0) * product.basePrice * product.discountRate; // å¯å†…è”æ¶ˆé™¤å˜é‡
    return {basePrice : basePrice, quantity : quantity, discount : discount};
}
function applyShipping(priceData, shippingMethod)
{
    const shippingPerCase = (priceData.basePrice > shippingMethod.discountThreshold)
                                ? shippingMethod.discountedFee
                                : shippingMethod.feePerCase;
    const shippingCost = priceData.quantity * shippingPerCase;
    const price = priceData.basePrice - priceData.discount + shippingCost; // å¯å†…è”æ¶ˆé™¤å˜é‡
    return price;
}
```

### STEP4. å†…è”æ¶ˆé™¤å¤šä½™çš„ `const` å˜é‡

```java
function priceOrder(product, quantity, shippingMethod)
{
    const priceData = calculatePricingData(product, quantity);
    return applyShipping(priceData, shippingMethod);
}
function calculatePricingData(product, quantity)
{
    const basePrice = product.basePrice * quantity;
    const discount = Math.max(quantity - product.discountThreshold, 0) * product.basePrice * product.discountRate;
    return {basePrice : basePrice, quantity : quantity, discount : discount};
}
function applyShipping(priceData, shippingMethod)
{
    const shippingPerCase = (priceData.basePrice > shippingMethod.discountThreshold)
                                ? shippingMethod.discountedFee
                                : shippingMethod.feePerCase;
    const shippingCost = priceData.quantity * shippingPerCase;
    return priceData.basePrice - priceData.discount + shippingCost;
}
```

## é‡æ„å®ŒæˆğŸ€
