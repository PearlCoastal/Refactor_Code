<!--
 * @Author: FEIFEI SUN
 * @Description: 
 * @Detail: 
 * @Date: 2023-04-28 10:10:45
 * 
-->
# 11.5 ä»¥æŸ¥è¯¢å–ä»£å‚æ•°

![](../img/11.5.jpg)

> [åå‘é‡æ„ï¼š11.6 ä»¥å‚æ•°å–ä»£æŸ¥è¯¢](./11.6_replace_query_with_parameter.md)

## ä½¿ç”¨åœºæ™¯

- å‡½æ•°çš„å‚æ•°åˆ—è¡¨åº”è¯¥æ€»ç»“è¯¥å‡½æ•°çš„å¯å˜æ€§ï¼Œè¡¨ç¤ºå‡ºå‡½æ•°å¯èƒ½ä½“ç°å‡ºè¡Œä¸ºå·®å¼‚çš„ä¸»è¦æ–¹å¼

- å‚æ•°åˆ—è¡¨åº”è¯¥å°½é‡é¿å…é‡å¤ï¼Œå¹¶ä¸”å‚æ•°åˆ—è¡¨è¶ŠçŸ­å°±è¶Šå®¹æ˜“ç†è§£

### é‡æ„å‰

```java
class Order
{
    get finalPrice()
    {
        const basePrice = this.quantity * this.itemPrice;
        let discountLevel;
        if (this.quantity > 100) discountLevel = 2;
        else discountLevel = 1;
        return this.discountedPrice(basePrice, discountLevel);
    }
    discountedPrice(basePrice, discountLevel)
    {
        switch (discountLevel)
        {
            case 1: return basePrice * 0.95;
            case 2: return basePrice * 0.9;
        }
    }
}
```

### STEP1. åˆ©ç”¨ [7.4 ä»¥æŸ¥è¯¢å–ä»£ä¸´æ—¶å˜é‡](../Chapter_7/7.4_replace_temp_with_query.md)

```java
class Order
{
    get finalPrice()
    {
        const basePrice = this.quantity * this.itemPrice;
        return this.discountedPrice(basePrice, this.discountLevel);
    }
    get discountLevel()
    {
        return (this.quantity > 100) ? 2 : 1;
    }
    discountedPrice(basePrice, discountLevel)
    {
        switch (this.discountLevel)
        {
            case 1: return basePrice * 0.95;
            case 2: return basePrice * 0.9;
        }
    }
}
```

### STEP2. åˆ©ç”¨ [6.5 æ”¹å˜å‡½æ•°å£°æ˜](../Chapter_6/6.5_change_function_declaration.md) æ‰‹æ³•ç§»é™¤ `discountedPrice` çš„ `discountLevel` å…¥å‚

```java
class Order
{
    get finalPrice()
    {
        const basePrice = this.quantity * this.itemPrice;
        return this.discountedPrice(basePrice/*, this.discountLevel*/);
    }
    get discountLevel()
    {
        return (this.quantity > 100) ? 2 : 1;
    }
    discountedPrice(basePrice/*, discountLevel*/)
    {
        switch (this.discountLevel)
        {
            case 1: return basePrice * 0.95;
            case 2: return basePrice * 0.9;
        }
    }
}
```

## é‡æ„å®ŒæˆğŸ€
